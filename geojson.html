<html>

<head>
    <title>A D3 map</title>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="stateshighres.js"></script>
    <script src="Data/state_data.js"></script>
</head>

<body>
    <script>
        // Build the map
        var width = 1000,
            height = 580;

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        var albersProjection = d3.geo.albers()
            .scale(1000)
            .rotate([100, 0])
            .center([0, 35])
            .translate([width / 2, height / 2]);

        var geoPath = d3.geo.path()
            .projection(albersProjection);

        g.selectAll("path")
            .data(stateshighres.features)
            .enter()
            .append("path")
            .attr("fill", getFill)
            .attr("d", geoPath);

        function getFill(d) {
            var name = d.properties.NAME;
            if (name == "Puerto Rico") { // No AP data
                return "#ccc";
            }
            var data = state_data[name];
            var fill = data["net"].data;
            console.log(255-fill);
            return "rgb(" + (255 - fill) + ", 0, " + fill + ")";
        }
    </script>
</body>

</html>

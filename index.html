<html>

<head>
    <title>Flow of College Students from State to State</title>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="state_location_data.js"></script>
    <script src="Data/state_data.js"></script>
</head>

<body>
    <script>
        // Calculate data set info
        var net_info = {},
            maxVal = -Infinity,
            minVal = Infinity;
        for (var state in state_data) {
            if (state_data.hasOwnProperty(state)) {
                n = state_data[state]["net"].data;
                if (n > maxVal) {
                    maxVal = n;
                }
                if (n < minVal) {
                    minVal = n;
                }
            }
        }
        net_info["min"] = minVal;
        net_info["max"] = maxVal;

        // Build the map
        var width = 1000;
        height = 500;

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        var projection = d3.geo.albersUsa()
            .scale(1000)
            .translate([width / 2, height / 2]);

        var geoPath = d3.geo.path()
            .projection(projection);

        g.selectAll("path")
            .data(stateshighres.features)
            .enter()
            .append("path")
            .attr("fill", getFill)
            .attr("d", geoPath);


        function getFill(d) {
            var name = d.properties.NAME;
            var data = state_data[name];
            var net = data["net"].data;
            net = (net > 0) ? Math.floor(((net * 1.0) / net_info["max"]) * 255) : Math.floor((net * 1.0) / net_info["min"] * 255);
            console.log(net)
            return "rgb(" + (-1 * net) + ", 0, " + net + ")";
        }
    </script>
</body>

</html>

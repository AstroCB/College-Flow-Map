<html>

<head>
    <title>Flow of College Students from State to State</title>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="state_location_data.js"></script>
    <script src="Data/state_data.js"></script>
</head>

<body>
    <script>
        // Build the map
        var width = 1000;
        height = 500;

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        var projection = d3.geo.albersUsa()
            .scale(1000)
            .translate([width / 2, height / 2]);

        var geoPath = d3.geo.path()
            .projection(projection);

        g.selectAll("path")
            .data(stateshighres.features)
            .enter()
            .append("path")
            .attr("fill", getFill)
            .attr("d", geoPath);

        function getFill(d) {
            var name = d.properties.NAME;
            var data = state_data[name];
            var leavingFactor = data["leaving"].data.num / data["population"].data;
            var enteringFactor = data["entering"].data / data["population"].data;
            var blue = Math.floor(leavingFactor * 100 * 255);
            var red = Math.floor(enteringFactor * 100 * 255);
            return "rgb(" + red + ", 0, " + blue + ")";
        }
    </script>
</body>

</html>
